{"version":3,"sources":["../src/heatmap.js"],"names":["name","context","factory","module","exports","define","amd","HeatmapConfig","defaultRadius","defaultRenderer","defaultGradient","defaultMaxOpacity","defaultMinOpacity","defaultBlur","defaultXField","defaultYField","defaultValueField","plugins","Store","StoreClosure","config","_coordinator","_data","_radi","_min","_max","_xField","_yField","_valueField","_cfgRadius","prototype","_organiseData","dataPoint","forceRender","x","y","radi","store","max","min","value","radius","storedVal","setDataMax","setDataMin","_unOrganizeData","unorganizedData","data","push","_onExtremaChange","emit","addData","arguments","length","dataArr","dataLen","call","organisedEntry","setData","dataPoints","pointsLen","i","_getInternalData","removeData","setCoordinator","coordinator","getData","Canvas2dRenderer","Canvas2dRendererClosure","_getColorPalette","gradientConfig","gradient","paletteCanvas","document","createElement","paletteCtx","getContext","width","height","createLinearGradient","key","addColorStop","fillStyle","fillRect","getImageData","_getPointTemplate","blurFactor","tplCanvas","tplCtx","beginPath","arc","Math","PI","fill","createRadialGradient","_prepareData","renderData","xValues","Object","keys","xValuesLen","xValue","yValues","yValuesLen","yValue","container","shadowCanvas","canvas","renderBoundaries","_renderBoundaries","computed","getComputedStyle","className","_width","replace","_height","shadowCtx","ctx","style","cssText","position","appendChild","_palette","_templates","_setStyles","renderPartial","_drawAlpha","_colorize","renderAll","_clear","_updateGradient","updateConfig","setDimensions","clearRect","_blur","blur","backgroundColor","_opacity","opacity","_maxOpacity","maxOpacity","_minOpacity","minOpacity","_useGradientOpacity","useGradientOpacity","point","rectX","rectY","tpl","templateAlpha","globalAlpha","drawImage","maxWidth","maxHeight","img","imgData","len","palette","alpha","offset","finalAlpha","putImageData","getValueAt","abs","getDataURL","toDataURL","Renderer","RendererClosure","rendererFn","Util","merge","merged","argsLen","obj","Heatmap","HeatmapClosure","Coordinator","CoordinatorClosure","cStore","on","evtName","callback","scope","_connect","renderer","_renderer","_store","_config","onExtremaChange","pluginToLoad","Error","plugin","apply","configure","repaint","heatmapFactory","create","register","pluginKey"],"mappings":"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","file":"heatmap.js","sourcesContent":["/*\n * heatmap.js v2.0.5 | JavaScript Heatmap Library\n *\n * Copyright 2008-2016 Patrick Wied <heatmapjs@patrick-wied.at> - All rights reserved.\n * Dual licensed under MIT and Beerware license \n *\n * :: 2016-09-05 01:16\n */\n;(function (name, context, factory) {\n\n  // Supports UMD. AMD, CommonJS/Node.js and browser context\n  if (typeof module !== \"undefined\" && module.exports) {\n    module.exports = factory();\n  } else if (typeof define === \"function\" && define.amd) {\n    define(factory);\n  } else {\n    context[name] = factory();\n  }\n\n})(\"h337\", this, function () {\n\n// Heatmap Config stores default values and will be merged with instance config\nvar HeatmapConfig = {\n  defaultRadius: 40,\n  defaultRenderer: 'canvas2d',\n  defaultGradient: { 0.25: \"rgb(0,0,255)\", 0.55: \"rgb(0,255,0)\", 0.85: \"yellow\", 1.0: \"rgb(255,0,0)\"},\n  defaultMaxOpacity: 1,\n  defaultMinOpacity: 0,\n  defaultBlur: .85,\n  defaultXField: 'x',\n  defaultYField: 'y',\n  defaultValueField: 'value', \n  plugins: {}\n};\nvar Store = (function StoreClosure() {\n\n  var Store = function Store(config) {\n    this._coordinator = {};\n    this._data = [];\n    this._radi = [];\n    this._min = 10;\n    this._max = 1;\n    this._xField = config['xField'] || config.defaultXField;\n    this._yField = config['yField'] || config.defaultYField;\n    this._valueField = config['valueField'] || config.defaultValueField;\n\n    if (config[\"radius\"]) {\n      this._cfgRadius = config[\"radius\"];\n    }\n  };\n\n  var defaultRadius = HeatmapConfig.defaultRadius;\n\n  Store.prototype = {\n    // when forceRender = false -> called from setData, omits renderall event\n    _organiseData: function(dataPoint, forceRender) {\n        var x = dataPoint[this._xField];\n        var y = dataPoint[this._yField];\n        var radi = this._radi;\n        var store = this._data;\n        var max = this._max;\n        var min = this._min;\n        var value = dataPoint[this._valueField] || 1;\n        var radius = dataPoint.radius || this._cfgRadius || defaultRadius;\n\n        if (!store[x]) {\n          store[x] = [];\n          radi[x] = [];\n        }\n\n        if (!store[x][y]) {\n          store[x][y] = value;\n          radi[x][y] = radius;\n        } else {\n          store[x][y] += value;\n        }\n        var storedVal = store[x][y];\n\n        if (storedVal > max) {\n          if (!forceRender) {\n            this._max = storedVal;\n          } else {\n            this.setDataMax(storedVal);\n          }\n          return false;\n        } else if (storedVal < min) {\n          if (!forceRender) {\n            this._min = storedVal;\n          } else {\n            this.setDataMin(storedVal);\n          }\n          return false;\n        } else {\n          return { \n            x: x, \n            y: y,\n            value: value, \n            radius: radius,\n            min: min,\n            max: max \n          };\n        }\n    },\n    _unOrganizeData: function() {\n      var unorganizedData = [];\n      var data = this._data;\n      var radi = this._radi;\n\n      for (var x in data) {\n        for (var y in data[x]) {\n\n          unorganizedData.push({\n            x: x,\n            y: y,\n            radius: radi[x][y],\n            value: data[x][y]\n          });\n\n        }\n      }\n      return {\n        min: this._min,\n        max: this._max,\n        data: unorganizedData\n      };\n    },\n    _onExtremaChange: function() {\n      this._coordinator.emit('extremachange', {\n        min: this._min,\n        max: this._max\n      });\n    },\n    addData: function() {\n      if (arguments[0].length > 0) {\n        var dataArr = arguments[0];\n        var dataLen = dataArr.length;\n        while (dataLen--) {\n          this.addData.call(this, dataArr[dataLen]);\n        }\n      } else {\n        // add to store  \n        var organisedEntry = this._organiseData(arguments[0], true);\n        if (organisedEntry) {\n          // if it's the first datapoint initialize the extremas with it\n          if (this._data.length === 0) {\n            this._min = this._max = organisedEntry.value;\n          }\n          this._coordinator.emit('renderpartial', {\n            min: this._min,\n            max: this._max,\n            data: [organisedEntry]\n          });\n        }\n      }\n      return this;\n    },\n    setData: function(data) {\n      var dataPoints = data.data;\n      var pointsLen = dataPoints.length;\n\n\n      // reset data arrays\n      this._data = [];\n      this._radi = [];\n\n      for(var i = 0; i < pointsLen; i++) {\n        this._organiseData(dataPoints[i], false);\n      }\n      this._max = data.max;\n      this._min = data.min || 0;\n      \n      this._onExtremaChange();\n      this._coordinator.emit('renderall', this._getInternalData());\n      return this;\n    },\n    removeData: function() {\n      // TODO: implement\n    },\n    setDataMax: function(max) {\n      this._max = max;\n      this._onExtremaChange();\n      this._coordinator.emit('renderall', this._getInternalData());\n      return this;\n    },\n    setDataMin: function(min) {\n      this._min = min;\n      this._onExtremaChange();\n      this._coordinator.emit('renderall', this._getInternalData());\n      return this;\n    },\n    setCoordinator: function(coordinator) {\n      this._coordinator = coordinator;\n    },\n    _getInternalData: function() {\n      return { \n        max: this._max,\n        min: this._min, \n        data: this._data,\n        radi: this._radi \n      };\n    },\n    getData: function() {\n      return this._unOrganizeData();\n    }/*,\n\n      TODO: rethink.\n\n    getValueAt: function(point) {\n      var value;\n      var radius = 100;\n      var x = point.x;\n      var y = point.y;\n      var data = this._data;\n\n      if (data[x] && data[x][y]) {\n        return data[x][y];\n      } else {\n        var values = [];\n        // radial search for datapoints based on default radius\n        for(var distance = 1; distance < radius; distance++) {\n          var neighbors = distance * 2 +1;\n          var startX = x - distance;\n          var startY = y - distance;\n\n          for(var i = 0; i < neighbors; i++) {\n            for (var o = 0; o < neighbors; o++) {\n              if ((i == 0 || i == neighbors-1) || (o == 0 || o == neighbors-1)) {\n                if (data[startY+i] && data[startY+i][startX+o]) {\n                  values.push(data[startY+i][startX+o]);\n                }\n              } else {\n                continue;\n              } \n            }\n          }\n        }\n        if (values.length > 0) {\n          return Math.max.apply(Math, values);\n        }\n      }\n      return false;\n    }*/\n  };\n\n\n  return Store;\n})();\n\nvar Canvas2dRenderer = (function Canvas2dRendererClosure() {\n\n  var _getColorPalette = function(config) {\n    var gradientConfig = config.gradient || config.defaultGradient;\n    var paletteCanvas = document.createElement('canvas');\n    var paletteCtx = paletteCanvas.getContext('2d');\n\n    paletteCanvas.width = 256;\n    paletteCanvas.height = 1;\n\n    var gradient = paletteCtx.createLinearGradient(0, 0, 256, 1);\n    for (var key in gradientConfig) {\n      gradient.addColorStop(key, gradientConfig[key]);\n    }\n\n    paletteCtx.fillStyle = gradient;\n    paletteCtx.fillRect(0, 0, 256, 1);\n\n    return paletteCtx.getImageData(0, 0, 256, 1).data;\n  };\n\n  var _getPointTemplate = function(radius, blurFactor) {\n    var tplCanvas = document.createElement('canvas');\n    var tplCtx = tplCanvas.getContext('2d');\n    var x = radius;\n    var y = radius;\n    tplCanvas.width = tplCanvas.height = radius*2;\n\n    if (blurFactor == 1) {\n      tplCtx.beginPath();\n      tplCtx.arc(x, y, radius, 0, 2 * Math.PI, false);\n      tplCtx.fillStyle = 'rgba(0,0,0,1)';\n      tplCtx.fill();\n    } else {\n      var gradient = tplCtx.createRadialGradient(x, y, radius*blurFactor, x, y, radius);\n      gradient.addColorStop(0, 'rgba(0,0,0,1)');\n      gradient.addColorStop(1, 'rgba(0,0,0,0)');\n      tplCtx.fillStyle = gradient;\n      tplCtx.fillRect(0, 0, 2*radius, 2*radius);\n    }\n\n\n\n    return tplCanvas;\n  };\n\n  var _prepareData = function(data) {\n    var renderData = [];\n    var min = data.min;\n    var max = data.max;\n    var radi = data.radi;\n    var data = data.data;\n\n    var xValues = Object.keys(data);\n    var xValuesLen = xValues.length;\n\n    while(xValuesLen--) {\n      var xValue = xValues[xValuesLen];\n      var yValues = Object.keys(data[xValue]);\n      var yValuesLen = yValues.length;\n      while(yValuesLen--) {\n        var yValue = yValues[yValuesLen];\n        var value = data[xValue][yValue];\n        var radius = radi[xValue][yValue];\n        renderData.push({\n          x: xValue,\n          y: yValue,\n          value: value,\n          radius: radius\n        });\n      }\n    }\n\n    return {\n      min: min,\n      max: max,\n      data: renderData\n    };\n  };\n\n\n  function Canvas2dRenderer(config) {\n    var container = config.container;\n    var shadowCanvas = this.shadowCanvas = document.createElement('canvas');\n    var canvas = this.canvas = config.canvas || document.createElement('canvas');\n    var renderBoundaries = this._renderBoundaries = [10000, 10000, 0, 0];\n\n    var computed = getComputedStyle(config.container) || {};\n\n    canvas.className = 'heatmap-canvas';\n\n    this._width = canvas.width = shadowCanvas.width = config.width || +(computed.width.replace(/px/,''));\n    this._height = canvas.height = shadowCanvas.height = config.height || +(computed.height.replace(/px/,''));\n\n    this.shadowCtx = shadowCanvas.getContext('2d');\n    this.ctx = canvas.getContext('2d');\n\n    // @TODO:\n    // conditional wrapper\n\n    canvas.style.cssText = shadowCanvas.style.cssText = 'position:absolute;left:0;top:0;';\n\n    container.style.position = 'relative';\n    container.appendChild(canvas);\n\n    this._palette = _getColorPalette(config);\n    this._templates = {};\n\n    this._setStyles(config);\n  };\n\n  Canvas2dRenderer.prototype = {\n    renderPartial: function(data) {\n      if (data.data.length > 0) {\n        this._drawAlpha(data);\n        this._colorize();\n      }\n    },\n    renderAll: function(data) {\n      // reset render boundaries\n      this._clear();\n      if (data.data.length > 0) {\n        this._drawAlpha(_prepareData(data));\n        this._colorize();\n      }\n    },\n    _updateGradient: function(config) {\n      this._palette = _getColorPalette(config);\n    },\n    updateConfig: function(config) {\n      if (config['gradient']) {\n        this._updateGradient(config);\n      }\n      this._setStyles(config);\n    },\n    setDimensions: function(width, height) {\n      this._width = width;\n      this._height = height;\n      this.canvas.width = this.shadowCanvas.width = width;\n      this.canvas.height = this.shadowCanvas.height = height;\n    },\n    _clear: function() {\n      this.shadowCtx.clearRect(0, 0, this._width, this._height);\n      this.ctx.clearRect(0, 0, this._width, this._height);\n    },\n    _setStyles: function(config) {\n      this._blur = (config.blur == 0)?0:(config.blur || config.defaultBlur);\n\n      if (config.backgroundColor) {\n        this.canvas.style.backgroundColor = config.backgroundColor;\n      }\n\n      this._width = this.canvas.width = this.shadowCanvas.width = config.width || this._width;\n      this._height = this.canvas.height = this.shadowCanvas.height = config.height || this._height;\n\n\n      this._opacity = (config.opacity || 0) * 255;\n      this._maxOpacity = (config.maxOpacity || config.defaultMaxOpacity) * 255;\n      this._minOpacity = (config.minOpacity || config.defaultMinOpacity) * 255;\n      this._useGradientOpacity = !!config.useGradientOpacity;\n    },\n    _drawAlpha: function(data) {\n      var min = this._min = data.min;\n      var max = this._max = data.max;\n      var data = data.data || [];\n      var dataLen = data.length;\n      // on a point basis?\n      var blur = 1 - this._blur;\n\n      while(dataLen--) {\n\n        var point = data[dataLen];\n\n        var x = point.x;\n        var y = point.y;\n        var radius = point.radius;\n        // if value is bigger than max\n        // use max as value\n        var value = Math.min(point.value, max);\n        var rectX = x - radius;\n        var rectY = y - radius;\n        var shadowCtx = this.shadowCtx;\n\n\n\n\n        var tpl;\n        if (!this._templates[radius]) {\n          this._templates[radius] = tpl = _getPointTemplate(radius, blur);\n        } else {\n          tpl = this._templates[radius];\n        }\n        // value from minimum / value range\n        // => [0, 1]\n        var templateAlpha = (value-min)/(max-min);\n        // this fixes #176: small values are not visible because globalAlpha < .01 cannot be read from imageData\n        shadowCtx.globalAlpha = templateAlpha < .01 ? .01 : templateAlpha;\n\n        shadowCtx.drawImage(tpl, rectX, rectY);\n\n        // update renderBoundaries\n        if (rectX < this._renderBoundaries[0]) {\n            this._renderBoundaries[0] = rectX;\n          }\n          if (rectY < this._renderBoundaries[1]) {\n            this._renderBoundaries[1] = rectY;\n          }\n          if (rectX + 2*radius > this._renderBoundaries[2]) {\n            this._renderBoundaries[2] = rectX + 2*radius;\n          }\n          if (rectY + 2*radius > this._renderBoundaries[3]) {\n            this._renderBoundaries[3] = rectY + 2*radius;\n          }\n\n      }\n    },\n    _colorize: function() {\n      var x = this._renderBoundaries[0];\n      var y = this._renderBoundaries[1];\n      var width = this._renderBoundaries[2] - x;\n      var height = this._renderBoundaries[3] - y;\n      var maxWidth = this._width;\n      var maxHeight = this._height;\n      var opacity = this._opacity;\n      var maxOpacity = this._maxOpacity;\n      var minOpacity = this._minOpacity;\n      var useGradientOpacity = this._useGradientOpacity;\n\n      if (x < 0) {\n        x = 0;\n      }\n      if (y < 0) {\n        y = 0;\n      }\n      if (x + width > maxWidth) {\n        width = maxWidth - x;\n      }\n      if (y + height > maxHeight) {\n        height = maxHeight - y;\n      }\n\n      var img = this.shadowCtx.getImageData(x, y, width, height);\n      var imgData = img.data;\n      var len = imgData.length;\n      var palette = this._palette;\n\n\n      for (var i = 3; i < len; i+= 4) {\n        var alpha = imgData[i];\n        var offset = alpha * 4;\n\n\n        if (!offset) {\n          continue;\n        }\n\n        var finalAlpha;\n        if (opacity > 0) {\n          finalAlpha = opacity;\n        } else {\n          if (alpha < maxOpacity) {\n            if (alpha < minOpacity) {\n              finalAlpha = minOpacity;\n            } else {\n              finalAlpha = alpha;\n            }\n          } else {\n            finalAlpha = maxOpacity;\n          }\n        }\n\n        imgData[i-3] = palette[offset];\n        imgData[i-2] = palette[offset + 1];\n        imgData[i-1] = palette[offset + 2];\n        imgData[i] = useGradientOpacity ? palette[offset + 3] : finalAlpha;\n\n      }\n\n      img.data = imgData;\n      this.ctx.putImageData(img, x, y);\n\n      this._renderBoundaries = [1000, 1000, 0, 0];\n\n    },\n    getValueAt: function(point) {\n      var value;\n      var shadowCtx = this.shadowCtx;\n      var img = shadowCtx.getImageData(point.x, point.y, 1, 1);\n      var data = img.data[3];\n      var max = this._max;\n      var min = this._min;\n\n      value = (Math.abs(max-min) * (data/255)) >> 0;\n\n      return value;\n    },\n    getDataURL: function() {\n      return this.canvas.toDataURL();\n    }\n  };\n\n\n  return Canvas2dRenderer;\n})();\n\n\nvar Renderer = (function RendererClosure() {\n\n  var rendererFn = false;\n\n  if (HeatmapConfig['defaultRenderer'] === 'canvas2d') {\n    rendererFn = Canvas2dRenderer;\n  }\n\n  return rendererFn;\n})();\n\n\nvar Util = {\n  merge: function() {\n    var merged = {};\n    var argsLen = arguments.length;\n    for (var i = 0; i < argsLen; i++) {\n      var obj = arguments[i]\n      for (var key in obj) {\n        merged[key] = obj[key];\n      }\n    }\n    return merged;\n  }\n};\n// Heatmap Constructor\nvar Heatmap = (function HeatmapClosure() {\n\n  var Coordinator = (function CoordinatorClosure() {\n\n    function Coordinator() {\n      this.cStore = {};\n    };\n\n    Coordinator.prototype = {\n      on: function(evtName, callback, scope) {\n        var cStore = this.cStore;\n\n        if (!cStore[evtName]) {\n          cStore[evtName] = [];\n        }\n        cStore[evtName].push((function(data) {\n            return callback.call(scope, data);\n        }));\n      },\n      emit: function(evtName, data) {\n        var cStore = this.cStore;\n        if (cStore[evtName]) {\n          var len = cStore[evtName].length;\n          for (var i=0; i<len; i++) {\n            var callback = cStore[evtName][i];\n            callback(data);\n          }\n        }\n      }\n    };\n\n    return Coordinator;\n  })();\n\n\n  var _connect = function(scope) {\n    var renderer = scope._renderer;\n    var coordinator = scope._coordinator;\n    var store = scope._store;\n\n    coordinator.on('renderpartial', renderer.renderPartial, renderer);\n    coordinator.on('renderall', renderer.renderAll, renderer);\n    coordinator.on('extremachange', function(data) {\n      scope._config.onExtremaChange &&\n      scope._config.onExtremaChange({\n        min: data.min,\n        max: data.max,\n        gradient: scope._config['gradient'] || scope._config['defaultGradient']\n      });\n    });\n    store.setCoordinator(coordinator);\n  };\n\n\n  function Heatmap() {\n    var config = this._config = Util.merge(HeatmapConfig, arguments[0] || {});\n    this._coordinator = new Coordinator();\n    if (config['plugin']) {\n      var pluginToLoad = config['plugin'];\n      if (!HeatmapConfig.plugins[pluginToLoad]) {\n        throw new Error('Plugin \\''+ pluginToLoad + '\\' not found. Maybe it was not registered.');\n      } else {\n        var plugin = HeatmapConfig.plugins[pluginToLoad];\n        // set plugin renderer and store\n        this._renderer = new plugin.renderer(config);\n        this._store = new plugin.store(config);\n      }\n    } else {\n      this._renderer = new Renderer(config);\n      this._store = new Store(config);\n    }\n    _connect(this);\n  };\n\n  // @TODO:\n  // add API documentation\n  Heatmap.prototype = {\n    addData: function() {\n      this._store.addData.apply(this._store, arguments);\n      return this;\n    },\n    removeData: function() {\n      this._store.removeData && this._store.removeData.apply(this._store, arguments);\n      return this;\n    },\n    setData: function() {\n      this._store.setData.apply(this._store, arguments);\n      return this;\n    },\n    setDataMax: function() {\n      this._store.setDataMax.apply(this._store, arguments);\n      return this;\n    },\n    setDataMin: function() {\n      this._store.setDataMin.apply(this._store, arguments);\n      return this;\n    },\n    configure: function(config) {\n      this._config = Util.merge(this._config, config);\n      this._renderer.updateConfig(this._config);\n      this._coordinator.emit('renderall', this._store._getInternalData());\n      return this;\n    },\n    repaint: function() {\n      this._coordinator.emit('renderall', this._store._getInternalData());\n      return this;\n    },\n    getData: function() {\n      return this._store.getData();\n    },\n    getDataURL: function() {\n      return this._renderer.getDataURL();\n    },\n    getValueAt: function(point) {\n\n      if (this._store.getValueAt) {\n        return this._store.getValueAt(point);\n      } else  if (this._renderer.getValueAt) {\n        return this._renderer.getValueAt(point);\n      } else {\n        return null;\n      }\n    }\n  };\n\n  return Heatmap;\n\n})();\n\n\n// core\nvar heatmapFactory = {\n  create: function(config) {\n    return new Heatmap(config);\n  },\n  register: function(pluginKey, plugin) {\n    HeatmapConfig.plugins[pluginKey] = plugin;\n  }\n};\n\nreturn heatmapFactory;\n\n\n});"]}